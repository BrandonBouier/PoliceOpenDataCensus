function showInfo(a,t){var e=Handlebars.compile($("#department-template").html());rawData=t.sheets("Completed Grid Data").all();var n=_.chain(rawData).map(function(a){return a["Type of Data"]}).unique().value();setupDatatypes(n);_.chain(rawData).groupBy("City").map(function(a,t){var e={department:t,departmentHref:URI().filename("datasets.html").search({department:t}).toString(),datasets:[]};return _.each(n,function(t){var n=_.find(a,function(a){return a["Type of Data"]===t});e.datasets.push(n?{free:n["Data is freely available online"],machine:n["Data is machine readable"],context:n["Context is provided"],bulk:n["Available in bulk"],fresh:n["Up-to-date"],incident:n["Incident-level data"],datasetHref:URI().filename("datasets.html").search({department:e.department,datatype:n["Type of Data"]}).toString()}:{free:"DNE",machine:"DNE",context:"DNE",bulk:"DNE",fresh:"DNE",incident:"DNE",datasetHref:"http://goo.gl/forms/WdJHdBmVLQ"})}),e}).each(function(a){var t=e(a);$("#departments").append(t)}).value();$('[data-toggle="tooltip"]').tooltip()}function setupDatatypes(a){var t=_.chain(a).map(function(a){return{datatype:a,datatypeHref:URI().filename(a.replace(/ /g,"")+".html").toString()}}).unique().value(),e=Handlebars.compile($("#dataset-template").html()),n=e(t);$("#datasets").append(n)}$(document).ready(function(){Tabletop.init({key:"1lv74SigFdFMJvza_dc2tBVd37r9E4-CPeY9YkRSaBxA",callback:showInfo,parseNumbers:!0})});var rawData=[];