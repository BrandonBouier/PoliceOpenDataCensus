function showInfo(a,e){var t=Handlebars.compile($("#department-template").html());rawData=e.sheets("Completed Grid Data").all();var n=_.chain(rawData).map(function(a){return a["Type of Data"]}).unique().value();setupDatatypes(n);_.chain(rawData).groupBy("City").map(function(a,e){var t={department:e,departmentHref:URI().filename("datasets.html").search({department:e}).toString(),datasets:[]};return _.each(n,function(e){var n=_.find(a,function(a){return a["Type of Data"]===e});t.datasets.push(n?{free:n["Data is freely available online"],machine:n["Data is machine readable"],context:n["Context is provided"],bulk:n["Available in bulk"],fresh:n["Up-to-date"],incident:n["Incident-level data"],datasetHref:URI().filename("datasets.html").search({department:t.department,datatype:n["Type of Data"]}).toString()}:{free:"DNE",machine:"DNE",context:"DNE",bulk:"DNE",fresh:"DNE",incident:"DNE",datasetHref:"http://goo.gl/forms/WdJHdBmVLQ"})}),t}).each(function(a){var e=t(a);$("#departments").append(e)}).value()}function setupDatatypes(a){var e=_.chain(a).map(function(a){return{datatype:a,datatypeHref:URI().filename(a.replace(/ /g,"")+".html").toString()}}).unique().value(),t=Handlebars.compile($("#dataset-template").html()),n=t(e);$("#datasets").append(n)}$(document).ready(function(){Tabletop.init({key:"1lv74SigFdFMJvza_dc2tBVd37r9E4-CPeY9YkRSaBxA",callback:showInfo,parseNumbers:!0})});var rawData=[];